```{r echo = FALSE, warning = FALSE, message = FALSE}
source("init.R")
```

# Body weight of fleas {#sec-temp}

*Last modified on `r format(fs::file_info("chapter-11-covariate-data.qmd")$modification_time, '%d. %B %Y at %H:%M:%S')`*

> *"A quote." --- Dan Meyer*

## General background

## Theoretical background

## R packages used

## Data

### Linear

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: fig-chap-11-cov-01-flea
#| fig-align: center
#| fig-height: 3
#| fig-width: 7
#| fig-cap: "foo **(A)** foo **(B)** foo"

ggplot() +
  theme_minimal() +
  theme_void() +
  coord_cartesian(xlim = c(-10, 15), ylim = c(-10, 10)) +
  geom_image(aes(x = 3, y = 0, image = "images/flea_00.png"), size = 1.05) +
  annotate("errorbar", xmin = -0.75, xmax = 9, x = 5, y = 9, color = "#FDC926FF") +
  annotate("text", x = (-0.75 + 8.75)/2, y = 10, label = "Body length in [mm]", 
           size = 3.75, fontface = 2, color = "#B12A90FF") +
  annotate("segment", x = seq(-0.75, 9, by = 0.25), xend = seq(-0.75, 9, by = 0.25),
           y = 8.8, yend = 9.2, color = "#FDC926FF") +
  geom_curve(aes(x = 3.5, y = -9.25, xend = 6, yend = -3.5),
             arrow = arrow(length = unit(0.02, "npc"), type = "closed"),
             curvature = 0.3, color = "#FDC926FF", linewidth = 0.5) +
  annotate("text", x = 3.3, y = -9.25, label = "Number of hairs on each back leg",
           hjust = "right", size = 3.75, fontface = 2, color = "#0D0887FF") +
  annotate("label", x = 6, y = 2, label = "Weight in [mg]", fill = "white", label.size = NA, 
           hjust = "center", color = "#B12A90FF", size = 3.75, fontface = 2) +
  geom_ellipse(aes(x0 = -10, y0 = -6.1, a = 0.25, b = 0.15, angle = 0), 
               color = "gray20", fill = "#F0F92180") +
  geom_curve(aes(x = 2.5, y = 3, xend = -10, yend = -6),
             arrow = arrow(length = unit(0.02, "npc"), type = "closed"),
             curvature = 0.75, color = "#FDC926FF", linewidth = 0.75, linetype = 1) +
  annotate("point", x = 2.5, y = 3, size = 3, color = "#FDC926FF") +
  annotate("errorbar", xmin = 2.5, xmax = -10, x = 2.5, y = -7, color = "#FDC926FF") +
  annotate("text", x = (2.5 + -10)/2, y = -6, label = "Jump length in [cm]", 
           size = 3.75, fontface = 2, color = "#0D0887FF") +
  annotate("segment", x = seq(-10, 2.5, by = 0.25), xend = seq(-10, 2.5, by = 0.25),
           y = -6.8, yend = -7.2, color = "#FDC926FF") +
  annotate("text", x = -1.5, y = 1.5, label = "Infection [no/yes]", 
           size = 3.75, fontface = 2, color = "#0D0887FF", hjust = "right") +
  ## upper
  geom_shape(data = tibble(x = c(9.4, 12.8, 12.8, 9.4), 
                           y = c(3.5, 3.5, 10, 10)),
             aes(x, y), radius = unit(0.2, 'cm'), fill = "#B12A90FF", alpha = 0.1) +
  annotate("text", hjust = "center", x = 11, y = 9, label = "Feeding",
           size = 3.75, fontface = 2, color = "#B12A90FF")  +
  annotate("text", hjust = "left", x = 9.5, y = c(7.5, 6, 4.5), 
           label = c("(1) sugar", "(2) ketchup", "(3) blood"),
           size = 3.25, fontface = 3, color = "gray35")  +
  geom_shape(data = tibble(x = c(12.9, 16, 16, 12.9), 
                           y = c(5, 5, 10, 10)),
             aes(x, y), radius = unit(0.2, 'cm'), fill = "#B12A90FF", alpha = 0.1) +
  annotate("text", hjust = "center", x = 14.5, y = 9, label = "Stage",
           size = 3.75, fontface = 2, color = "#B12A90FF") +
  annotate("text", hjust = "left", x = 13, y = c(7.5, 6), 
           label = c("(1) juvenile", "(2) adult"),
           size = 3.25, fontface = 3, color = "gray35") +
  ## lower
  geom_shape(data = tibble(x = c(9.4, 12.8, 12.8, 9.4), 
                           y = c(-8.5, -8.5, 1, 1)),
             aes(x, y), radius = unit(0.2, 'cm'), fill = "#0D0887FF", alpha = 0.1) +
  annotate("text", hjust = "center", x = 11, y = 0, label = "Rating",
           size = 3.75, fontface = 2, color = "#0D0887FF")  +
  annotate("text", hjust = "left", x = 9.5, y = c(-1.5, -3, -4.5, -6, -7.5), 
           label = c("(1) bad", "(2) poor", "(3) fair", "(4) good", "(5) excellent"),
           size = 3.25, fontface = 3, color = "gray35")  +
  geom_shape(data = tibble(x = c(12.9, 16, 16, 12.9), 
                           y = c(-5.5, -5.5, 1, 1)),
             aes(x, y), radius = unit(0.2, 'cm'), fill = "#B12A90FF", alpha = 0.1) +
  annotate("text", hjust = "center", x = 14.5, y = 0, label = "Host",
           size = 3.75, fontface = 2, color = "#B12A90FF") +
  annotate("text", hjust = "left", x = 13, y = c(-1.5, -3, -4.5), 
           label = c("(1) cat", "(2) dog", "(3) fox"),
           size = 3.25, fontface = 3, color = "gray35") 


```
Quality Rating (ACR): 1-Bad, 2-Poor, 3-Fair, 4-Good, 5-Excellent.

```{r}
jump_weight_tbl <- tibble(x = abs(rnorm(21, 3, 4)),
                          y = 10 + 1.2 * x + rnorm(21, 0, 2)) |>
  mutate_all(round, 1) |> 
  rename(weight = x, jumplength = y)
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: fig-chap-11-cov-01
#| fig-align: center
#| fig-height: 3.5
#| fig-width: 7
#| fig-cap: "foo **(A)** foo **(B)** foo"

jump_weight_tbl |> 
  ggplot(aes(x = weight, y = jumplength, fill = col_pal(1, 0.5))) +
  theme_book() +
  geom_point(show.legend = FALSE, shape = 21) +
  labs(x = "Cat flea weight [mg]", y = "Jump length in [cm]",
       fill = "Host") +
  scale_fill_viridis(discrete = TRUE, option = "plasma") +
  scale_x_continuous(breaks = 0:10) +
  coord_cartesian(xlim = c(0, NA), ylim = c(0, NA))
```

```{r}
library(mvtnorm)

sigma <- matrix(c(4,2,2,3), ncol=2)
x <- rmvnorm(n = 21, mean=c(1,2), sigma=sigma) |> 
  as_tibble() |> 
  rename(weight = V1, bodylength = V2)
colMeans(x)
var(x)
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: fig-chap-11-cov-02
#| fig-align: center
#| fig-height: 3.5
#| fig-width: 7
#| fig-cap: "foo **(A)** foo **(B)** foo"

x |> 
  ggplot(aes(x = weight, y = bodylength, fill = col_pal(1, 0.5))) +
  theme_book() +
  geom_point(show.legend = FALSE, shape = 21) +
  labs(x = "Cat flea weight [mg]", y = "Cat flea body length [mm]",
       fill = "Host") +
  scale_fill_viridis(discrete = TRUE, option = "plasma") #+
  # scale_x_continuous(breaks = 0:10) +
  # coord_cartesian(xlim = c(0, NA), ylim = c(0, NA))
```


### Non-linear


```{r}
jump_weight_non_linear_tbl <- tibble(x = abs(rnorm(32, 3, 4)),
                                     y = 0.15*x^3 - 2.2*x^2 + 8.8*x + 3.2 + rnorm(32, 0, 1)) |>
  rename(weight = x, jumplength = y)
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: fig-chap-11-cov-04
#| fig-align: center
#| fig-height: 3.5
#| fig-width: 7
#| fig-cap: "foo **(A)** foo **(B)** foo"

jump_weight_non_linear_tbl |> 
  ggplot(aes(x = weight, y = jumplength, fill = col_pal(1, 0.5))) +
  theme_book() +
  geom_point(show.legend = FALSE, shape = 21) +
  labs(x = "Cat flea weight [mg]", y = "Jump length in [cm]",
       fill = "Host") +
  scale_fill_viridis(discrete = TRUE, option = "plasma") +
  scale_x_continuous(breaks = 0:10) +
  coord_cartesian(xlim = c(0, NA), ylim = c(0, NA))
```


## Data availability

The data is available as txt-Files under <https://github.com/jkruppa/biodatascience>.

```{r}
#| echo: false

jump_weight_tbl |> 
  mutate_if(is.numeric, round, 2) |> 
  write_delim("data/jump_weight.txt")

jump_weight_non_linear_tbl |> 
  mutate_if(is.numeric, round, 2) |> 
  write_delim("data/jump_weight_non_linear.txt")
```


## Alternatives 

Further tutorials and R packages on XXX

## Glossary

term

: what does it mean.

## The meaning of "Models of Reality" in this chapter.

- itemize with max. 5-6 words

## Summary

## References {.unnumbered}