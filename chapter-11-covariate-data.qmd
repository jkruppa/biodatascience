```{r echo = FALSE, warning = FALSE}
source("init.R")
```

# Body weight of fleas {#sec-temp}

*Last modified on `r format(fs::file_info("chapter-11-covariate-data.qmd")$modification_time, '%d. %B %Y at %H:%M:%S')`*

> *"A quote." --- Dan Meyer*

## General background

## Theoretical background

## R packages used

## Data

### Linear

```{r}
jump_weight_tbl <- tibble(x = abs(rnorm(21, 5, 4)),
                          y = 10 + 1.2 * x + rnorm(21, 0, 2)) |>
  mutate_all(round, 1) |> 
  rename(weight_mg = x, jump_length_cm = y)
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: fig-chap-11-cov-01
#| fig-align: center
#| fig-height: 3.5
#| fig-width: 7
#| fig-cap: "foo **(A)** foo **(B)** foo"

jump_weight_tbl |> 
  ggplot(aes(x = weight_mg, y = jump_length_cm, fill = col_pal(1, 0.5))) +
  theme_book() +
  geom_point(show.legend = FALSE, shape = 21) +
  labs(x = "Cat flea weight [mg]", y = "Jump length in [cm]",
       fill = "Host") +
  scale_fill_viridis(discrete = TRUE, option = "plasma") +
  coord_cartesian(xlim = c(0, NA), ylim = c(0, NA))
```



```{r}
jump_weight_feeding_tbl <- expand_grid(f = c(0, 1), 
                                       x = abs(rnorm(21, 5, 4))) |> 
  mutate(y = 10 + 1.2 * x + 10 * f + rnorm(42, 0, 2),
         f = factor(f, labels = c("sugar_water", "blood")))  |>
  mutate_if(is.numeric, round, 1) |> 
  rename(weight_mg = x, jump_length_cm = y, feeding = f) 
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: fig-chap-11-cov-02
#| fig-align: center
#| fig-height: 3.5
#| fig-width: 7
#| fig-cap: "foo **(A)** foo **(B)** foo"

jump_weight_feeding_tbl |> 
  ggplot(aes(x = weight_mg, y = jump_length_cm, fill = feeding)) +
  theme_book() +
  geom_point(shape = 21) +
  labs(x = "Cat flea weight [mg]", y = "Jump length in [cm]",
       fill = "Feeding") +
  scale_fill_viridis(discrete = TRUE, option = "plasma",
                     labels = c("Sugar water", "Blood")) +
  coord_cartesian(xlim = c(0, NA), ylim = c(0, NA))
```

### Non-linear


```{r}
jump_weight_non_linear_tbl <- tibble(x = abs(rnorm(21, 4, 3)),
                                     y = 0.15*x^3 - 2.2*x^2 + 8.8*x + 3.2 + rnorm(21, 0, 1)) |>
  rename(weight_mg = x, jump_length_cm = y)
```

```{r}
#| echo: false
#| message: false
#| warning: false
#| label: fig-chap-11-cov-04
#| fig-align: center
#| fig-height: 3.5
#| fig-width: 7
#| fig-cap: "foo **(A)** foo **(B)** foo"

jump_weight_non_linear_tbl |> 
  ggplot(aes(x = weight_mg, y = jump_length_cm, fill = col_pal(1, 0.5))) +
  theme_book() +
  geom_point(show.legend = FALSE, shape = 21) +
  labs(x = "Cat flea weight [mg]", y = "Jump length in [cm]",
       fill = "Host") +
  scale_fill_viridis(discrete = TRUE, option = "plasma") +
  coord_cartesian(xlim = c(0, NA), ylim = c(0, NA))
```


```{r}
jump_weight_non_linear_tbl <- tibble(x = abs(rnorm(21, 2, 2)),
                                     y = 20 - 18 * exp(-0.2 * x^2) + rnorm(21, 0, 2)) |>
  rename(weight_mg = x, jump_length_cm = y)
```

```{r}
jump_weight_non_linear_tbl <- expand_grid(f = c(0, 1), 
                                          x = abs(rnorm(42, 2.5, 2.5))) |> 
  mutate(y = 25 - 4*f - 21 * exp(-0.2 * x^2 - 1.1 * f) + rnorm(84, 0, 1),
         f = factor(f, labels = c("sugar_water", "blood")))  |>
  mutate_if(is.numeric, round, 1) |> 
  rename(weight_mg = x, jump_length_cm = y, feeding = f) 
```


```{r}
#| echo: false
#| message: false
#| warning: false
#| label: fig-chap-11-cov-05
#| fig-align: center
#| fig-height: 3.5
#| fig-width: 7
#| fig-cap: "foo **(A)** foo **(B)** foo"

jump_weight_non_linear_tbl |> 
  ggplot(aes(x = weight_mg, y = jump_length_cm, fill = feeding)) +
  theme_book() +
  geom_point(shape = 21) +
  labs(x = "Cat flea weight [mg]", y = "Jump length in [cm]",
       fill = "Host") +
  scale_fill_viridis(discrete = TRUE, option = "plasma",
                     labels = c("Sugar water", "Blood")) +
  coord_cartesian(xlim = c(0, NA), ylim = c(0, NA)) 
```


## Alternatives 

Further tutorials and R packages on XXX

## Glossary

term

: what does it mean.

## The meaning of "Models of Reality" in this chapter.

- itemize with max. 5-6 words

## Summary

## References {.unnumbered}