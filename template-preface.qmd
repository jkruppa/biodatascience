```{r echo = FALSE, warning = FALSE, message = FALSE}
source("init.R")
pacman::p_load(tidyverse)
```

# Template Preface

*Last modified on `r format(fs::file_info("template-preface.qmd")$modification_time, '%d. %B %Y at %H:%M:%S')`*

> *"What problem have you solved, ever, that was worth solving where you knew all the given information in advance? No problem worth solving is like that. In the real world, you have a surplus of information and you have to filter it, or you don't have sufficient information and you have to go find some." --- [Dan Meyer in  Math class needs a makeover](https://www.ted.com/talks/dan_meyer_math_class_needs_a_makeover?language=en&subtitle=en&trigger=5s)*

Here comes the preface text

If square dancing is the peak of order, geometry, and external command, its perfect chaotic counterpart would be Moshing (or the "Mosh Pit").

While square dancing relies on a "caller" to synchronize everyone into rigid patterns, moshing relies on individual impulse, physical impact, and organic flow.

In a square dance, you are a component of a machine. If you fail to follow the caller, the machine stops. In a mosh pit, you are a molecule in a gas. You collide, bounce, and redirect based on the energy of the crowd. It is the ultimate expression of entropy in dance.

If you first hear of a line, then you might think of a Euclidiean line.

```{r}
#| message: false
#| echo: false
#| warning: false
#| fig-align: center
#| fig-height: 2
#| fig-width: 5
#| fig-cap: "Visualisation of a line through two points, also known as a Euclidean line. Most people think of such a line first when they think about lines through points. This is mathematically correct, but not in statistics."
#| label: fig-euclidiean-line

ggplot() +
  theme_void() +
  ##coord_equal() +
  ##theme_minimal() +
  scale_x_continuous(breaks = seq(-5, 5, 1), limits = c(-0.25, 5)) +
  scale_y_continuous(breaks = seq(-5, 5, 1), limits = c(-0.25, 2.25)) +
  annotate("segment", x = -0.15, y = 0, xend = 5, yend = 0,
           arrow = arrow(length = unit(0.04, "npc"), type = "closed")) +
  annotate("segment", x = c(1, 2, 3, 4), xend = c(1, 2, 3, 4),
           y = -0.05, yend = 0.05) +
  annotate("segment", x = 0, y = -0.2, xend = 0, yend = 2.25,
           arrow = arrow(length = unit(0.04, "npc"), type = "closed")) +  
  annotate("segment", x = -0.05, xend = 0.05,
           y = c(1, 2), yend = c(1, 2)) +
  ## line
  annotate("segment", x = 0.5, y = 0.5, xend = 4.5, yend = 1.5, color = "gray50",
           size = 1) +
  annotate("point", x = c(0.5, 4.5), y = c(0.5, 1.5)) +
  annotate("text", x = c(0.5, 4.5), y = c(0.5, 1.5) - 0.25, label = c("A", "B"),
           size = 5, fontface = 2) +
  labs(title = "This is a Euclidean line") +
  theme(plot.title = element_text(size = 16, face = "bold"),
        plot.subtitle = element_text(size = 12, face = "italic"))

```


A possible line through points. Is this the best possible line?


```{r}
#| message: false
#| echo: false
#| warning: false
#| fig-align: center
#| fig-height: 3
#| fig-width: 5
#| fig-cap: "Visualisation of a line through many points is a key concept in statistics. The line rarely hits all the points, so there is always a deviation between the line and the points. The line is described by coefficients, or parameters: the intercept, where the line passes the y-axis, and the slope, which is the rate of change of the line. **(A)** Linear dependency. We observe one intercept, one slope and four deviations. **(B)** non linear dependency. We observe one intercept, up to $p$ slopes and four deviations."
#| label: fig-euclidiean-line-01

p1 <- ggplot() +
  theme_void() +
  coord_equal() +
 ## theme_minimal() +
  scale_x_continuous(breaks = seq(-5, 5, 1), limits = c(0.25, 5)) +
  scale_y_continuous(breaks = seq(-5, 5, 1), limits = c(0.25, 5)) +
  annotate("segment", x = 0.4, y = 0.5, xend = 5, yend = 0.5,
           arrow = arrow(length = unit(0.02, "npc"), type = "closed")) +
  annotate("segment", x = c(1.5, 2.5, 3.5, 4.5), xend = c(1.5, 2.5, 3.5, 4.5),
           y = 0.45, yend = 0.55) +
  annotate("segment", x = 0.5, y = 0.4, xend = 0.5, yend = 5,
           arrow = arrow(length = unit(0.02, "npc"), type = "closed")) +
  annotate("segment", y = c(1.5, 2.5, 3.5, 4.5), yend = c(1.5, 2.5, 3.5, 4.5),
           x = 0.475, xend = 0.525) +
  ## line
  annotate("segment", x = c(1.5, 2, 3, 4.5), y = c(2, 3.5, 4, 3.5), 
           xend = c(1.5, 2, 3, 4.5), yend = 2 + (c(1.5, 2, 3, 4.5)-0.5) * 0.55,
           color = "#FCA636FF", size = 1, lineend = "round") +
  annotate("text", x = c(1.5, 2, 3, 4.5)+0.2, 
           y = (c(2, 3.5, 4, 3.5) + (2 + (c(1.5, 2, 3, 4.5)-0.5) * 0.55))/2,
           color = "#FCA636FF", label = c(expression(epsilon[1]), expression(epsilon[2]),
                                          expression(epsilon[3]), expression(epsilon[4]))) +  
  annotate("segment", x = 0.5, y = 2, xend = 5, yend = 4.5, color = "gray50",
           size = 1) +
  ## parameters
  annotate("point", x = 0.5, y = 2, fill = "#0D0887FF", size = 3, shape = 21) +
  annotate("text", x = 0.35, y = 2, color = "#0D0887FF",
           label = expression(beta[0]))  +
  annotate("segment", x = 2.25, y = 2+(2.25-0.5)*0.55, xend = 3.25, yend = 2+(2.25-0.5)*0.55,
           color = "#B12A9080", size = 1, linetype = "11") +
  annotate("segment", x = 3.25, y = 2+(2.25-0.5)*0.55, xend = 3.25, yend = 2+(3.25-0.5)*0.55,
           color = "#B12A9080", size = 1, linetype = "11") +
  annotate("segment", x = 2.25, y = 2+(2.25-0.5)*0.55, xend = 3.25, yend = 2+(3.25-0.5)*0.55,
           color = "#B12A90FF", size = 1.25) +
  annotate("point", x = 2.75, y = 2+(2.75-0.5)*0.55, fill = "#B12A90FF", size = 3, shape = 21) +  
  annotate("text", x = 2.75, y = 3.2375+0.2, color = "#B12A90FF",
           label = expression(beta[1]))  +
  ## points
  annotate("point", x = c(1.5, 2, 3, 4.5), y = c(2, 3.5, 4, 3.5)) +
  ## box
  geom_shape(data = tibble(x = c(3, 4.75, 4.75, 3), 
                           y = c(0.75, 0.75, 2.75, 2.75)),
             aes(x, y), radius = unit(0.2, 'cm'), fill = "gray95") +
  annotate("text", x = (3+4.75)/2, y = 2.5, label = "Parameters",
           fontface = 2, size = 5) +
  annotate("text", x = 3.1, y = c(2, 1.5, 1), size = 4.5,
           label = c("1 Intercept", "1 Slope", "n Deviations"),
           fontface = 4, hjust = "left", color = c("#0D0887FF", "#B12A90FF", "#FCA636FF")) +
  annotate("text", x = 4.5, y = c(2, 1.5, 1), 
           label = c(expression(beta[0]), expression(beta[1]), expression(epsilon)),
           size = 4.5, hjust = "center") +
  labs(title = "This is a linear line")  +
  theme(plot.title = element_text(size = 16, face = "bold"),
        plot.subtitle = element_text(size = 12, face = "italic"))


p2 <- ggplot() +
  theme_void() +
coord_equal() +
 ## theme_minimal() +
  scale_x_continuous(breaks = seq(-5, 5, 1), limits = c(0.25, 5)) +
  scale_y_continuous(breaks = seq(-5, 5, 1), limits = c(0.25, 5)) +
  annotate("segment", x = 0.4, y = 0.5, xend = 5, yend = 0.5,
           arrow = arrow(length = unit(0.02, "npc"), type = "closed")) +
  annotate("segment", x = c(1.5, 2.5, 3.5, 4.5), xend = c(1.5, 2.5, 3.5, 4.5),
           y = 0.45, yend = 0.55) +
  annotate("segment", x = 0.5, y = 0.4, xend = 0.5, yend = 5,
           arrow = arrow(length = unit(0.02, "npc"), type = "closed")) +
  annotate("segment", y = c(1.5, 2.5, 3.5, 4.5), yend = c(1.5, 2.5, 3.5, 4.5),
           x = 0.475, xend = 0.525) +
  ## line
  annotate("segment", 
           x = c(1.5, 2, 3, 4.5), 
           y = c(2, 3.5, 4, 3.5), 
           xend = c(1.5, 2, 3, 4.5), 
           yend = c(2.9, 3.25, 3.55, 3.25),
           color = "#FCA636FF", size = 1, lineend = "round") +
  annotate("text", x = c(1.5, 2, 3, 4.5)+c(0.2, -0.2, 0.2, 0.2), 
           y = (c(2, 3.5, 4, 3.5) + c(2.9, 3.25, 3.55, 3.25))/2,
           color = "#FCA636FF", 
           label = c(expression(epsilon[1]), expression(epsilon[2]),
                     expression(epsilon[3]), expression(epsilon[4]))) +  
  geom_curve(aes(x = 0.5, y = 1, xend = 5, yend = 3),
             curvature = -0.6, color = "gray50", size = 1) +
  ## points
  annotate("point", x = c(1.5, 2, 3, 4.5), y = c(2, 3.5, 4, 3.5)) +
  ## parameters
  annotate("point", x = 0.5, y = 1, color = "#0D0887FF", size = 3) +
  annotate("text", x = 0.35, y = 1, color = "#0D0887FF",
           label = expression(beta[0]))  +
  annotate("segment", x = 0.75, y = 2.15, xend = 1.75, yend = 3.15,
           color = "#B12A90FF", size = 1.25) +
  annotate("point", x = 1.25, y = 2.65, fill = "#B12A90FF", size = 3, shape = 21) +
  annotate("segment", x = 2.25, y = 3.4, xend = 3.25, yend = 3.6,
           color = "#B12A90FF", size = 1.25) +
  annotate("point", x = 2.75, y = 3.5, fill = "#B12A90FF", size = 3, shape = 21) +
  annotate("segment", x = 3.75, y = 3.575, xend = 4.75, yend = 3.175,
           color = "#B12A90FF", size = 1.25) +
  annotate("point", x = 4.25, y = 3.38, fill = "#B12A90FF", size = 3, shape = 21) +
  annotate("text", x = c(1.25, 2.75, 4.25), y = c(2.65, 3.5, 3.38)+0.2, 
           color = "#B12A90FF",
           label = c(expression(beta[1]), expression(beta[2]), expression(beta[3])))  +
 ## box
  geom_shape(data = tibble(x = c(3, 4.75, 4.75, 3), 
                           y = c(0.75, 0.75, 2.75, 2.75)),
             aes(x, y), radius = unit(0.2, 'cm'), fill = "gray95") +
  annotate("text", x = (3+4.75)/2, y = 2.5, label = "Parameters",
           fontface = 2, size = 5) +
  annotate("text", x = 3.1, y = c(2, 1.5, 1), size = 4.5, 
           label = c("1 Intercept", "p Slopes", "n Deviations"),
           fontface = 4, hjust = "left", color = c("#0D0887FF", "#B12A90FF", "#FCA636FF")) +
  annotate("text", x = 4.5, y = c(2, 1.5, 1), 
           label = c(expression(beta[0]), expression(beta[p]), expression(epsilon)),
           size = 4.5, hjust = "center") +
  labs(title = "This is a non linear line")  +
  theme(plot.title = element_text(size = 16, face = "bold"),
        plot.subtitle = element_text(size = 12, face = "italic"))


p1 + p2 +
  plot_layout(ncol = 2) +
  plot_annotation(tag_levels = 'A', tag_prefix = '(', tag_suffix = ')') &
  theme(plot.tag = element_text(size = 16, face = "bold"))
```
